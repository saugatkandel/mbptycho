function lambda = etolambda(energy,probe_flag);% ETOLAMBDA - Convert from energy (in eV) to wavelength (in Å)%% Usage: lambda = etolambda(energy{,probe_flag})% % Calculates the wavelength of radiation, given the energy.% The calculation depends on the nature of the radiation,% which is specified via the global PROBE; PROBE=0 is% x-rays (the default), while PROBE=1 is electrons.%% Input:    %   energy = array of energies (in eV)%   probe_flag = (optional) string to override the setting%                of PROBE. 'e'=electrons, 'x'=x-rays.%% Output:   %   lambda = array of wavelengths (in Å)%% See also: LAMBDATOE, FHC% T. Hufnagel (hufnagel@jhu.edu) Johns Hopkins University% TCH 05-May-03 Comments added and constant updated% TCH 08-May-03 Added PROBE and conversion for electrons% Reference for electron wavelength: % D. B. Williams and C. B. Carter, "Transmission Electron Microscopy: % A Textbook for Materials Science" (Plenum, 1996).% Note that this routine corrects a typographical error in the book.global PROBEif isempty(PROBE)    PROBE=0;         % X-ray scattering is the defaultendif nargin<2         % User did not override PROBE   radiation=PROBE;else                % User did override PROBE    switch lower(probe_flag(1))        case 'e'    % Electrons            radiation=1;        case 'x'    % X-rays             radiation=0;        otherwise            error('Unknown value of probe_flag! (Should be ''e'' or ''x''.)')    endendswitch radiation    case 0          % x-rays        lambda = 12398.4244./energy;    case 1          % electrons            h=6.626e-34;    % Planck's constant (N m s)        mo=9.109e-31;   % Electron rest mass (kg)        c=2.998e8;      % Speed of light (m/s)        energy=energy.*1.602e-19; % Convert energy to J (from eV)        lambda=h./sqrt(2.*mo.*energy.*(1+energy./(2.*mo.*c.^2))); % Calculate wavelength (in m)        lambda=lambda*1e10; % Convert to Ångstroms    otherwise        error('Unknown value of global PROBE! (Should be 0 for x-rays, 1 for electrons.)')end